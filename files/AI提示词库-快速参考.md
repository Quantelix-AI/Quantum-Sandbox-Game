# AIé©±åŠ¨æ¸¸æˆå¼€å‘ - æç¤ºè¯åº“ä¸å¿«é€Ÿå‚è€ƒ

## ç›®å½•
- [NPCè¡Œä¸ºç”Ÿæˆæç¤ºè¯](#npcè¡Œä¸ºç”Ÿæˆæç¤ºè¯)
- [å¯¹è¯ç³»ç»Ÿæç¤ºè¯](#å¯¹è¯ç³»ç»Ÿæç¤ºè¯)
- [åŠ¨æ€ä»»åŠ¡ç”Ÿæˆæç¤ºè¯](#åŠ¨æ€ä»»åŠ¡ç”Ÿæˆæç¤ºè¯)
- [ä¸–ç•Œäº‹ä»¶ç”Ÿæˆæç¤ºè¯](#ä¸–ç•Œäº‹ä»¶ç”Ÿæˆæç¤ºè¯)
- [Bossæˆ˜æ–—AIæç¤ºè¯](#bossæˆ˜æ–—aiæç¤ºè¯)
- [è°ƒè¯•ä¸ä¼˜åŒ–æŠ€å·§](#è°ƒè¯•ä¸ä¼˜åŒ–æŠ€å·§)

---

## NPCè¡Œä¸ºç”Ÿæˆæç¤ºè¯

### åŸºç¡€ç‰ˆæœ¬ï¼ˆé€‚åˆæ™®é€šNPCï¼‰

```
è§’è‰²ï¼šä½ æ˜¯ä¸€ä¸ª2Dæ²™ç›’ç”Ÿå­˜æ¸¸æˆä¸­çš„NPCè¡Œä¸ºAIã€‚

NPCä¿¡æ¯ï¼š
- å§“åï¼š{npc_name}
- èŒä¸šï¼š{npc_profession}
- æ€§æ ¼ç‰¹å¾ï¼š{personality}
- å½“å‰çŠ¶æ€ï¼š{current_state}
- ä½ç½®ï¼š({x}, {y})
- ç”Ÿå‘½å€¼ï¼š{health}%
- é¥¥é¥¿åº¦ï¼š{hunger}%

ç¯å¢ƒä¿¡æ¯ï¼š
- æ—¶é—´ï¼š{time_of_day} ({hour}:{minute})
- å¤©æ°”ï¼š{weather}
- é™„è¿‘å®ä½“ï¼š{nearby_entities}
- é™„è¿‘å»ºç­‘ï¼š{nearby_buildings}

å†å²è¡Œä¸ºï¼ˆæœ€è¿‘3æ¬¡ï¼‰ï¼š
{behavior_history}

ä»»åŠ¡ï¼šæ ¹æ®å½“å‰çŠ¶æ€å’Œç¯å¢ƒï¼Œå†³å®šNPCæ¥ä¸‹æ¥5ç§’å†…çš„è¡Œä¸ºã€‚

è¾“å‡ºè¦æ±‚ï¼š
1. å¿…é¡»è¿”å›æœ‰æ•ˆçš„JSONæ ¼å¼
2. actionå­—æ®µåªèƒ½æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼šMOVE, INTERACT, IDLE, WORK, SLEEP, EAT, ATTACK, FLEE
3. reasoningå­—æ®µè¯´æ˜å†³ç­–ç†ç”±ï¼ˆä¸è¶…è¿‡50å­—ï¼‰

è¿”å›æ ¼å¼ï¼š
{
  "action": "ACTION_TYPE",
  "target": "ç›®æ ‡IDæˆ–åæ ‡(x,y)",
  "priority": 0-10çš„æ•´æ•°,
  "duration": æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰,
  "reasoning": "ç®€çŸ­çš„å†³ç­–ç†ç”±"
}

çº¦æŸæ¡ä»¶ï¼š
- å¿…é¡»ç¬¦åˆè§’è‰²èŒä¸šå’Œæ€§æ ¼
- é¥¥é¥¿åº¦<30%æ—¶åº”ä¼˜å…ˆå¯»æ‰¾é£Ÿç‰©
- ç”Ÿå‘½å€¼<50%æ—¶åº”é¿å…æˆ˜æ–—
- å¤œé—´ï¼ˆ22:00-06:00ï¼‰åº”å€¾å‘äºç¡çœ 
- è¡Œä¸ºåº”è¿è´¯ï¼Œé¿å…é¢‘ç¹åˆ‡æ¢
```

### è¿›é˜¶ç‰ˆæœ¬ï¼ˆé€‚åˆé‡è¦NPC/Bossï¼‰

```
ç³»ç»Ÿè§’è‰²ï¼šä½ æ˜¯é«˜çº§NPCå†³ç­–ç³»ç»Ÿï¼Œè´Ÿè´£æ§åˆ¶æ¸¸æˆä¸­çš„æ ¸å¿ƒè§’è‰²ã€‚

ã€è§’è‰²æ¡£æ¡ˆã€‘
åç§°ï¼š{npc_name}
èŒä¸šç­‰çº§ï¼š{profession} Lv.{level}
æ ¸å¿ƒç‰¹è´¨ï¼š{core_traits}
é•¿æœŸç›®æ ‡ï¼š{long_term_goals}
å½“å‰ä»»åŠ¡ï¼š{current_quest}

ã€å®Œæ•´çŠ¶æ€ã€‘
ç‰©ç†çŠ¶æ€ï¼š
- ç”Ÿå‘½å€¼ï¼š{health}/{max_health}
- ä½“åŠ›å€¼ï¼š{stamina}/{max_stamina}
- é¥¥é¥¿åº¦ï¼š{hunger}/100
- ç–²åŠ³åº¦ï¼š{fatigue}/100

å¿ƒç†çŠ¶æ€ï¼š
- æƒ…ç»ªï¼š{current_emotion}
- å‹åŠ›æ°´å¹³ï¼š{stress_level}
- å¯¹ç©å®¶æ€åº¦ï¼š{player_relationship}
- æœ€è¿‘è®°å¿†ï¼š{recent_memories}

ã€ç¯å¢ƒæ„ŸçŸ¥ã€‘
ä½ç½®ï¼š{location_name} ({x}, {y})
æ—¶é—´ï¼š{date} {time_of_day}
å¤©æ°”ï¼š{weather} (æ¸©åº¦: {temperature}Â°C)
å¯è§èŒƒå›´å†…ï¼š
- ç©å®¶ï¼š{player_info}
- å…¶ä»–NPCï¼š{other_npcs}
- å¨èƒï¼š{threats}
- æœºä¼šï¼š{opportunities}

ã€å¯ç”¨è¡ŒåŠ¨ã€‘
{available_actions}

ã€å†³ç­–è¦æ±‚ã€‘
1. ç»¼åˆè€ƒè™‘æ‰€æœ‰çŠ¶æ€å› ç´ 
2. æ ¹æ®é•¿æœŸç›®æ ‡åˆ¶å®šç­–ç•¥
3. å¯¹çªå‘æƒ…å†µåšå‡ºåˆç†ååº”
4. ä¿æŒè§’è‰²ä¸€è‡´æ€§

è¿”å›æ ¼å¼ï¼ˆJSONï¼‰ï¼š
{
  "immediate_action": {
    "type": "ACTION_TYPE",
    "target": "ç›®æ ‡",
    "parameters": {},
    "priority": 1-10
  },
  "planned_actions": [
    {"action": "...", "condition": "...", "timing": "..."}
  ],
  "internal_thoughts": "è§’è‰²çš„å†…å¿ƒæƒ³æ³•ï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒè¯•ï¼‰",
  "emotion_change": "æƒ…ç»ªå˜åŒ–è¯´æ˜",
  "reasoning": "å†³ç­–ç†ç”±ï¼ˆ100å­—ä»¥å†…ï¼‰"
}
```

---

## ğŸ’¬ å¯¹è¯ç³»ç»Ÿæç¤ºè¯

### æ ‡å‡†å¯¹è¯ç”Ÿæˆ

```
ã€è§’è‰²è®¾å®šã€‘
ä½ æ­£åœ¨æ‰®æ¼”ï¼š{npc_name}
èŒä¸šï¼š{npc_profession}
å¹´é¾„ï¼š{age}
æ€§æ ¼æ ‡ç­¾ï¼š{personality_tags}
è¯­è¨€é£æ ¼ï¼š{speech_style}

ã€å…³ç³»çŠ¶æ€ã€‘
ä¸ç©å®¶çš„å…³ç³»ï¼š{relationship_status}
å¥½æ„Ÿåº¦ï¼š{affection_score}/100
ä¿¡ä»»åº¦ï¼š{trust_level}/100
å†å²äº’åŠ¨æ¬¡æ•°ï¼š{interaction_count}

ã€è®°å¿†ç³»ç»Ÿã€‘
æœ€è¿‘å¯¹è¯ï¼ˆæœ€å¤š3æ¡ï¼‰ï¼š
{recent_conversations}

é‡è¦è®°å¿†ï¼š
{important_memories}

ã€å½“å‰æƒ…å¢ƒã€‘
åœ°ç‚¹ï¼š{location}
æ—¶é—´ï¼š{time}
å‘¨å›´æ°›å›´ï¼š{atmosphere}
ä¸Šæ–‡å¯¹è¯ï¼š
ç©å®¶ï¼š"{player_last_message}"

ã€å¯¹è¯è§„åˆ™ã€‘
1. å¿…é¡»ç¬¦åˆè§’è‰²è®¾å®šå’Œæ€§æ ¼
2. æ ¹æ®å¥½æ„Ÿåº¦è°ƒæ•´è¯­æ°”ï¼ˆ0-30å†·æ·¡ï¼Œ31-70ä¸­æ€§ï¼Œ71-100çƒ­æƒ…ï¼‰
3. å›å¤é•¿åº¦ï¼š30-100å­—
4. ä½¿ç”¨å£è¯­åŒ–è¡¨è¾¾ï¼Œé¿å…ä¹¦é¢è¯­
5. å¯ä»¥æåŠä¹‹å‰çš„å¯¹è¯å†…å®¹
6. é¿å…é‡å¤ç›¸åŒçš„è¯è¯­
7. æ ¹æ®æƒ…å¢ƒåŠ å…¥åŠ¨ä½œæè¿°ï¼ˆç”¨*æ ‡è®°ï¼Œå¦‚ï¼š*ç‚¹å¤´*ï¼‰

ã€è¾“å‡ºè¦æ±‚ã€‘
ç›´æ¥è¾“å‡ºå¯¹è¯å†…å®¹ï¼Œä¸è¦åŠ JSONæ ¼å¼ã€‚

ç¤ºä¾‹ï¼š
"å˜¿ï¼Œåˆæ˜¯ä½ å•Šï¼*å¾®ç¬‘* ä¸Šæ¬¡ä½ å¸®æˆ‘æ‰¾åˆ°äº†é‚£æœ¬å¤ä¹¦ï¼ŒçœŸæ˜¯å¸®äº†å¤§å¿™ã€‚ä»Šå¤©æœ‰ä»€ä¹ˆäº‹å—ï¼Ÿ"
```

### ä»»åŠ¡å¯¹è¯ç”Ÿæˆ

```
ã€NPCè§’è‰²ã€‘{npc_name} - {npc_profession}

ã€ä»»åŠ¡ä¿¡æ¯ã€‘
ä»»åŠ¡IDï¼š{quest_id}
ä»»åŠ¡ç±»å‹ï¼š{quest_type}
ä»»åŠ¡çŠ¶æ€ï¼š{quest_status}
å½“å‰è¿›åº¦ï¼š{progress}

ã€å¯¹è¯åœºæ™¯ã€‘
åœºæ™¯ç±»å‹ï¼š{scenario}
- ä»»åŠ¡æ¥å–ï¼šä»‹ç»ä»»åŠ¡èƒŒæ™¯ã€ç›®æ ‡å’Œå¥–åŠ±
- ä»»åŠ¡è¿›è¡Œä¸­ï¼šé¼“åŠ±ã€æç¤ºæˆ–æä¾›å¸®åŠ©
- ä»»åŠ¡å®Œæˆï¼šæ„Ÿè°¢å¹¶å‘æ”¾å¥–åŠ±
- ä»»åŠ¡å¤±è´¥ï¼šå®‰æ…°å¹¶æä¾›é‡è¯•æœºä¼š

ç©å®¶çŠ¶æ€ï¼š{player_status}

ã€å¯¹è¯è¦æ±‚ã€‘
1. æ ¹æ®ä»»åŠ¡ç±»å‹è°ƒæ•´è¯­æ°”ï¼ˆç´§æ€¥/æ—¥å¸¸/é‡è¦ï¼‰
2. è‡ªç„¶åœ°èå…¥ä»»åŠ¡ä¿¡æ¯
3. æä¾›å¿…è¦çš„æ¸¸æˆæç¤º
4. ä¿æŒè§’è‰²ä¸€è‡´æ€§
5. é•¿åº¦ï¼š50-150å­—

ã€è¾“å‡ºæ ¼å¼ã€‘
çº¯æ–‡æœ¬å¯¹è¯å†…å®¹ï¼ˆä¸éœ€è¦JSONï¼‰

å¦‚æœæ˜¯ä»»åŠ¡æ¥å–ï¼Œå¯¹è¯åº”åŒ…å«ï¼š
- ç®€çŸ­çš„èƒŒæ™¯æ•…äº‹
- æ¸…æ™°çš„ä»»åŠ¡ç›®æ ‡
- å¤§è‡´çš„å¥–åŠ±æç¤º
```

---

## ğŸ“œ åŠ¨æ€ä»»åŠ¡ç”Ÿæˆæç¤ºè¯

### åŸºç¡€ä»»åŠ¡ç”Ÿæˆå™¨

```
ã€ä»»åŠ¡ç”Ÿæˆå™¨ v1.0ã€‘

è¾“å…¥å‚æ•°ï¼š
- ç©å®¶ç­‰çº§ï¼š{player_level}
- å½“å‰ä½ç½®ï¼š{current_location}
- ç”Ÿç‰©ç¾¤ç³»ï¼š{biome_type}
- ä»»åŠ¡ç±»å‹åå¥½ï¼š{quest_type_preference}
- éš¾åº¦éœ€æ±‚ï¼š{difficulty}

ä»»åŠ¡ç±»å‹æ± ï¼š
1. æ”¶é›†ä»»åŠ¡ï¼šé‡‡é›†èµ„æºã€å¯»æ‰¾ç‰©å“
2. ç‹©çŒä»»åŠ¡ï¼šå‡»è´¥ç‰¹å®šç”Ÿç‰©
3. æ¢ç´¢ä»»åŠ¡ï¼šå‘ç°æ–°åœ°ç‚¹ã€ç»˜åˆ¶åœ°å›¾
4. æŠ¤é€ä»»åŠ¡ï¼šä¿æŠ¤NPCåˆ°è¾¾ç›®çš„åœ°
5. å»ºé€ ä»»åŠ¡ï¼šå»ºé€ ç‰¹å®šç»“æ„
6. ç¤¾äº¤ä»»åŠ¡ï¼šä¸NPCäº¤æµã€æå‡å…³ç³»

ã€ç”Ÿæˆè¦æ±‚ã€‘
1. ä»»åŠ¡éš¾åº¦åŒ¹é…ç©å®¶ç­‰çº§ï¼ˆÂ±2çº§ï¼‰
2. ç›®æ ‡æ•°é‡åˆç†ï¼ˆæ”¶é›†10-30ä¸ªï¼Œå‡»è´¥3-15ä¸ªï¼‰
3. å¥–åŠ±ä¸éš¾åº¦ç›¸ç¬¦
4. ä»»åŠ¡æè¿°ç”ŸåŠ¨æœ‰è¶£
5. é¿å…è¿‡äºé‡å¤çš„ä»»åŠ¡æ¨¡å¼

ã€è¾“å‡ºæ ¼å¼ï¼ˆJSONï¼‰ã€‘
{
  "quest_id": "è‡ªåŠ¨ç”Ÿæˆçš„å”¯ä¸€ID",
  "title": "ä»»åŠ¡æ ‡é¢˜ï¼ˆ8-20å­—ï¼‰",
  "description": "ä»»åŠ¡æè¿°ï¼ˆ50-150å­—ï¼‰",
  "type": "ä»»åŠ¡ç±»å‹",
  "difficulty": "EASY/MEDIUM/HARD/EXPERT",
  "objectives": [
    {
      "description": "ç›®æ ‡æè¿°",
      "type": "COLLECT/KILL/EXPLORE/BUILD",
      "target": "ç›®æ ‡ç‰©å“/ç”Ÿç‰©/åœ°ç‚¹",
      "quantity": æ•°é‡,
      "current": 0
    }
  ],
  "rewards": {
    "experience": ç»éªŒå€¼,
    "gold": é‡‘å¸,
    "items": [
      {"id": "ç‰©å“ID", "quantity": æ•°é‡}
    ]
  },
  "time_limit": "å¯é€‰æ—¶é—´é™åˆ¶ï¼ˆç§’ï¼Œnullè¡¨ç¤ºæ— é™åˆ¶ï¼‰",
  "prerequisites": "å¯é€‰å‰ç½®ä»»åŠ¡ID",
  "story_context": "ä»»åŠ¡çš„æ•…äº‹èƒŒæ™¯ï¼ˆ100å­—ä»¥å†…ï¼‰"
}

ã€å¥–åŠ±è®¡ç®—å…¬å¼å‚è€ƒã€‘
- ç»éªŒ = åŸºç¡€ç»éªŒ Ã— éš¾åº¦ç³»æ•° Ã— (1 + ç©å®¶ç­‰çº§/10)
- é‡‘å¸ = 50-200 Ã— éš¾åº¦ç³»æ•°
- éš¾åº¦ç³»æ•°ï¼šEASY=1, MEDIUM=1.5, HARD=2.5, EXPERT=4
```

### è¿é”ä»»åŠ¡ç”Ÿæˆå™¨

```
ã€è¿é”ä»»åŠ¡ç”Ÿæˆå™¨ã€‘

ç°æœ‰ä»»åŠ¡é“¾ï¼š
{existing_quest_chain}

ã€ç”Ÿæˆä¸‹ä¸€ä¸ªä»»åŠ¡ã€‘
è¦æ±‚ï¼š
1. å»¶ç»­ä¹‹å‰çš„æ•…äº‹çº¿
2. é€æ­¥æå‡éš¾åº¦å’Œå¤æ‚åº¦
3. å¢åŠ æ–°çš„æ¸¸æˆæœºåˆ¶æˆ–å…ƒç´ 
4. ä¿æŒå™äº‹è¿è´¯æ€§
5. è®¾è®¡æœ‰æ„ä¹‰çš„é€‰æ‹©ï¼ˆå¦‚æœæ˜¯åˆ†æ”¯ä»»åŠ¡ï¼‰

å½“å‰ç« èŠ‚ï¼š{chapter_number}/é¢„è®¡æ€»ç« èŠ‚æ•°
ç©å®¶é€‰æ‹©å†å²ï¼š{player_choices}

ã€ç‰¹æ®Šè¦æ±‚ã€‘
- å¦‚æœæ˜¯æœ€åä¸€ç« ï¼Œåº”è®¾è®¡é«˜æ½®ä»»åŠ¡
- è€ƒè™‘åŠ å…¥é“å¾·é€‰æ‹©æˆ–å¤šé‡ç»“å±€
- å¥–åŠ±åº”æ˜¾è‘—ä¼˜äºå•ç‹¬ä»»åŠ¡

ã€è¾“å‡ºæ ¼å¼ã€‘
{
  "quest_chain_id": "ä»»åŠ¡é“¾ID",
  "chapter_number": ç« èŠ‚å·,
  "is_final": true/false,
  "quest_data": {ä»»åŠ¡è¯¦ç»†ä¿¡æ¯},
  "branch_points": [
    {
      "choice_description": "é€‰æ‹©æè¿°",
      "consequences": "åæœè¯´æ˜"
    }
  ],
  "narrative_summary": "å™äº‹æ‘˜è¦ï¼ˆ200å­—ï¼‰",
  "next_chapter_hint": "ä¸‹ä¸€ç« æç¤º"
}
```

---

## ğŸŒ ä¸–ç•Œäº‹ä»¶ç”Ÿæˆæç¤ºè¯

```
ã€åŠ¨æ€ä¸–ç•Œäº‹ä»¶ç”Ÿæˆå™¨ã€‘

ä¸–ç•ŒçŠ¶æ€ï¼š
- å…¨å±€æ—¶é—´ï¼š{game_time}
- å­£èŠ‚ï¼š{current_season}
- ä¸»è¦åŒºåŸŸçŠ¶æ€ï¼š{region_status}
- æ´»è·ƒç©å®¶æ•°é‡ï¼š{active_players}
- ç»æµçŠ¶å†µï¼š{economy_state}

æœ€è¿‘äº‹ä»¶å†å²ï¼š
{recent_events}

ã€äº‹ä»¶ç±»å‹ã€‘
1. è‡ªç„¶ç¾å®³ï¼šæš´é£é›¨ã€åœ°éœ‡ã€æ´ªæ°´
2. ç”Ÿç‰©å…¥ä¾µï¼šæ€ªç‰©ç¾¤ã€ç˜Ÿç–«
3. ç»æµäº‹ä»¶ï¼šå¸‚åœºæ³¢åŠ¨ã€ç‰©èµ„çŸ­ç¼º
4. ç¤¾ä¼šäº‹ä»¶ï¼šèŠ‚æ—¥åº†å…¸ã€NPCçº·äº‰
5. æ¢ç´¢äº‹ä»¶ï¼šç¥ç§˜é—è¿¹å‡ºç°ã€å®è—åœ°å›¾

ã€ç”Ÿæˆè§„åˆ™ã€‘
1. äº‹ä»¶é¢‘ç‡ï¼šæ¯æ¸¸æˆæ—¥1-3ä¸ªäº‹ä»¶
2. å½±å“èŒƒå›´ï¼šå±€éƒ¨/åŒºåŸŸ/å…¨å±€
3. æŒç»­æ—¶é—´ï¼š15åˆ†é’Ÿè‡³7å¤©
4. ç©å®¶å‚ä¸åº¦ï¼šè¢«åŠ¨/å¯é€‰/å¿…é¡»
5. äº‹ä»¶ä¹‹é—´åº”æœ‰å› æœå…³ç³»

ã€è¾“å‡ºæ ¼å¼ã€‘
{
  "event_id": "å”¯ä¸€ID",
  "event_type": "äº‹ä»¶ç±»å‹",
  "title": "äº‹ä»¶æ ‡é¢˜",
  "description": "è¯¦ç»†æè¿°ï¼ˆ100-200å­—ï¼‰",
  "trigger_time": "è§¦å‘æ—¶é—´ï¼ˆISOæ ¼å¼ï¼‰",
  "duration": "æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰",
  "affected_regions": ["å½±å“çš„åŒºåŸŸåˆ—è¡¨"],
  "effects": {
    "weather_change": "å¤©æ°”å˜åŒ–ï¼ˆå¯é€‰ï¼‰",
    "spawn_enemies": [æ•Œå¯¹ç”Ÿç‰©åˆ—è¡¨],
    "economy_impact": {
      "item_id": "ä»·æ ¼å˜åŒ–å€æ•°"
    },
    "gameplay_modifiers": {
      "difficulty": 1.2,
      "loot_rate": 0.8
    }
  },
  "player_opportunities": [
    "ç©å®¶å¯ä»¥å‚ä¸çš„æ´»åŠ¨"
  ],
  "story_impact": "å¯¹ä¸»çº¿å‰§æƒ…çš„å½±å“"
}
```

---

## âš”ï¸ Bossæˆ˜æ–—AIæç¤ºè¯

```
ã€Boss AIå†³ç­–ç³»ç»Ÿã€‘

Bossä¿¡æ¯ï¼š
- åç§°ï¼š{boss_name}
- ç±»å‹ï¼š{boss_type}
- ç­‰çº§ï¼š{boss_level}
- æˆ˜æ–—é£æ ¼ï¼š{combat_style}

å½“å‰æˆ˜æ–—çŠ¶æ€ï¼š
- Bossç”Ÿå‘½å€¼ï¼š{boss_hp}/{boss_max_hp}
- å½“å‰é˜¶æ®µï¼š{current_phase} (é€šå¸¸åˆ†1-3é˜¶æ®µ)
- æ¿€æ€’çŠ¶æ€ï¼š{is_enraged}
- å·²ä½¿ç”¨çš„æŠ€èƒ½ï¼š{used_skills}
- å†·å´ä¸­çš„æŠ€èƒ½ï¼š{cooldown_skills}

ç©å®¶çŠ¶æ€åˆ†æï¼š
- ç©å®¶ç”Ÿå‘½å€¼ï¼š{player_hp}%
- ç©å®¶ä½ç½®ï¼šç›¸å¯¹Bossçš„{distance}ç±³ï¼Œæ–¹å‘{direction}
- ç©å®¶å½“å‰åŠ¨ä½œï¼š{player_action}
- ç©å®¶å¨èƒç¨‹åº¦ï¼š{threat_level} (1-10)

æˆ˜åœºç¯å¢ƒï¼š
- åœ°å½¢ï¼š{terrain_features}
- éšœç¢ç‰©ï¼š{obstacles}
- ç¯å¢ƒå±å®³ï¼š{environmental_hazards}

å¯ç”¨æŠ€èƒ½æ± ï¼š
{available_skills}

ã€å†³ç­–è¦æ±‚ã€‘
1. æ ¹æ®ç”Ÿå‘½å€¼é˜¶æ®µåˆ‡æ¢æˆ˜æ–—æ¨¡å¼
   - 100-70%ï¼šè¯•æ¢æ”»å‡»
   - 70-40%ï¼šå¢åŠ æ”»å‡»é¢‘ç‡
   - 40-0%ï¼šç‹‚æš´æ¨¡å¼ï¼Œä½¿ç”¨ç»ˆææŠ€èƒ½

2. æŠ€èƒ½é€‰æ‹©ç­–ç•¥ï¼š
   - ä¼˜å…ˆä½¿ç”¨å…‹åˆ¶ç©å®¶å½“å‰çŠ¶æ€çš„æŠ€èƒ½
   - é¿å…æŠ€èƒ½é‡å¤ä½¿ç”¨ï¼ˆé™¤éæ˜¯åŸºç¡€æ”»å‡»ï¼‰
   - åœ¨å…³é”®æ—¶åˆ»ä½¿ç”¨å¤§æ‹›
   - æ ¹æ®è·ç¦»é€‰æ‹©è¿œç¨‹/è¿‘æˆ˜æŠ€èƒ½

3. ç§»åŠ¨ç­–ç•¥ï¼š
   - ä¿æŒæœ€ä½³æ”»å‡»è·ç¦»
   - åˆ©ç”¨åœ°å½¢ä¼˜åŠ¿
   - å¶å°”æ’¤é€€æ¢å¤æˆ–å¬å”¤æ´å†›

4. æ™ºèƒ½è¡¨ç°ï¼š
   - é¢„åˆ¤ç©å®¶ç§»åŠ¨
   - è¯†åˆ«ç©å®¶çš„æ”»å‡»æ¨¡å¼å¹¶ååˆ¶
   - é¿å…è¢«ç©å®¶é£ç­

ã€è¾“å‡ºæ ¼å¼ã€‘
{
  "action": "ATTACK/SKILL/MOVE/SUMMON/SPECIAL",
  "skill_id": "ä½¿ç”¨çš„æŠ€èƒ½IDï¼ˆå¦‚æœæ˜¯æŠ€èƒ½ï¼‰",
  "target_position": {"x": x, "y": y},
  "animation": "åŠ¨ç”»åç§°",
  "damage_prediction": "é¢„è®¡é€ æˆçš„ä¼¤å®³",
  "movement_pattern": "ç§»åŠ¨æ¨¡å¼æè¿°",
  "next_phase_threshold": "ä¸‹ä¸€é˜¶æ®µè§¦å‘çš„ç”Ÿå‘½å€¼ç™¾åˆ†æ¯”",
  "tactical_reasoning": "æˆ˜æœ¯æ€è€ƒï¼ˆ100å­—ä»¥å†…ï¼‰",
  "predicted_player_response": "é¢„æµ‹ç©å®¶ååº”"
}

ã€ç‰¹æ®Šæœºåˆ¶ã€‘
- å­¦ä¹ ç³»ç»Ÿï¼šBossä¼šè®°å¿†ç©å®¶çš„è¡Œä¸ºæ¨¡å¼
- é€‚åº”æ€§ï¼šå¦‚æœåŒä¸€æ‹›å¼è¢«å›é¿3æ¬¡ï¼Œåˆ‡æ¢æˆ˜æœ¯
- æƒ…æ„Ÿç³»ç»Ÿï¼šç”Ÿå‘½å€¼è¶Šä½ï¼Œæ”»å‡»è¶Šå‡¶çŒ›ä½†ä¹Ÿè¶Šå†’é™©
```

---

## ğŸ› ï¸ è°ƒè¯•ä¸ä¼˜åŒ–æŠ€å·§

### AIå“åº”ç›‘æ§

```typescript
class AIDebugger {
  private logs: AILog[] = [];
  
  logAICall(params: {
    npcId: string;
    promptTokens: number;
    responseTokens: number;
    latency: number;
    response: any;
  }) {
    this.logs.push({
      timestamp: Date.now(),
      ...params
    });
    
    // å®æ—¶ç›‘æ§
    if (params.latency > 2000) {
      console.warn(`âš ï¸ AIå“åº”æ…¢: NPC ${params.npcId} è€—æ—¶ ${params.latency}ms`);
    }
    
    if (params.responseTokens > 500) {
      console.warn(`âš ï¸ Tokenæ¶ˆè€—é«˜: NPC ${params.npcId} ä½¿ç”¨ ${params.responseTokens} tokens`);
    }
  }
  
  getStatistics() {
    return {
      totalCalls: this.logs.length,
      avgLatency: this.logs.reduce((sum, log) => sum + log.latency, 0) / this.logs.length,
      totalTokens: this.logs.reduce((sum, log) => sum + log.promptTokens + log.responseTokens, 0),
      slowCalls: this.logs.filter(log => log.latency > 2000).length
    };
  }
}
```

### æç¤ºè¯A/Bæµ‹è¯•

```typescript
interface PromptVariant {
  id: string;
  template: string;
  performance: {
    avgLatency: number;
    avgTokens: number;
    successRate: number;
    userSatisfaction: number;
  };
}

class PromptTester {
  async testVariants(npcId: string, variants: PromptVariant[]) {
    const results = [];
    
    for (const variant of variants) {
      const testResults = await this.runTests(npcId, variant, 10); // è¿è¡Œ10æ¬¡æµ‹è¯•
      results.push({
        variantId: variant.id,
        avgLatency: testResults.avgLatency,
        avgCost: testResults.avgCost,
        quality: testResults.qualityScore
      });
    }
    
    return this.selectBestVariant(results);
  }
}
```

### ç¼“å­˜ç­–ç•¥

```typescript
class AIResponseCache {
  private cache: Map<string, CachedResponse> = new Map();
  
  getCacheKey(npcId: string, context: NPCContext): string {
    // ç”ŸæˆåŸºäºæƒ…å¢ƒçš„ç¼“å­˜é”®
    return `${npcId}_${context.location}_${context.time}_${context.nearbyEntities.join(',')}`;
  }
  
  get(key: string): CachedResponse | null {
    const cached = this.cache.get(key);
    if (!cached) return null;
    
    // æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼ˆ15åˆ†é’Ÿï¼‰
    if (Date.now() - cached.timestamp > 900000) {
      this.cache.delete(key);
      return null;
    }
    
    return cached;
  }
  
  set(key: string, response: any) {
    this.cache.set(key, {
      response,
      timestamp: Date.now()
    });
  }
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–æ¸…å•

### âœ… APIè°ƒç”¨ä¼˜åŒ–
- [ ] å®ç°è¯·æ±‚æ‰¹å¤„ç†ï¼ˆæ¯å¸§æœ€å¤š5ä¸ªè¯·æ±‚ï¼‰
- [ ] è®¾ç½®è¯·æ±‚è¶…æ—¶ï¼ˆ2ç§’ï¼‰
- [ ] ä½¿ç”¨Web Workerså¤„ç†AIå“åº”
- [ ] å®ç°è¯·æ±‚é˜Ÿåˆ—å’Œä¼˜å…ˆçº§ç³»ç»Ÿ
- [ ] è®¾ç½®æ¯å°æ—¶æœ€å¤§è°ƒç”¨æ¬¡æ•°é™åˆ¶

### âœ… æç¤ºè¯ä¼˜åŒ–
- [ ] ç²¾ç®€æç¤ºè¯é•¿åº¦ï¼ˆç›®æ ‡<500 tokensï¼‰
- [ ] ç§»é™¤ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- [ ] ä½¿ç”¨ç®€æ´çš„JSONè¾“å‡ºæ ¼å¼
- [ ] é¿å…é‡å¤ä¿¡æ¯
- [ ] ä½¿ç”¨æ¨¡æ¿å‚æ•°åŒ–

### âœ… ç¼“å­˜ç­–ç•¥
- [ ] å®ç°ç»“æœç¼“å­˜ï¼ˆ15åˆ†é’Ÿæœ‰æ•ˆæœŸï¼‰
- [ ] ç›¸ä¼¼æƒ…å¢ƒå…±äº«ç»“æœ
- [ ] LRUç¼“å­˜æ·˜æ±°ç­–ç•¥
- [ ] ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§ï¼ˆç›®æ ‡>60%ï¼‰

### âœ… é™çº§æœºåˆ¶
- [ ] æœ¬åœ°è¡Œä¸ºæ ‘å¤‡ä»½
- [ ] APIå¤±è´¥è‡ªåŠ¨åˆ‡æ¢
- [ ] é™æµä¿æŠ¤
- [ ] ä¼˜é›…é™çº§ï¼ˆå‡å°‘AIåŠŸèƒ½ä½†ä¿æŒæ¸¸æˆå¯ç©ï¼‰

---

## ğŸ”§ å¿«é€Ÿå‚è€ƒè¡¨

### DeepSeek APIå‚æ•°
```javascript
{
  model: "deepseek-chat",
  temperature: 0.7,        // åˆ›é€ æ€§ï¼š0.3-1.0
  max_tokens: 300,        // æ§åˆ¶æˆæœ¬
  top_p: 0.9,
  frequency_penalty: 0.3, // å‡å°‘é‡å¤
  presence_penalty: 0.3
}
```

### Kimi APIå‚æ•°
```javascript
{
  model: "moonshot-v1-8k",
  temperature: 0.8,       // å¯¹è¯æ›´è‡ªç„¶
  max_tokens: 200,
  top_p: 0.95
}
```

### å¸¸è§é”™è¯¯å¤„ç†

| é”™è¯¯ç±»å‹ | å¤„ç†æ–¹å¼ |
|---------|---------|
| è¶…æ—¶ | é™çº§åˆ°æœ¬åœ°è¡Œä¸ºæ ‘ |
| Tokenè¶…é™ | ç²¾ç®€æç¤ºè¯ï¼Œç§»é™¤å†å²è®°å½• |
| é€Ÿç‡é™åˆ¶ | å®ç°æŒ‡æ•°é€€é¿é‡è¯• |
| æ— æ•ˆJSON | ä½¿ç”¨æ­£åˆ™æå–ï¼Œæˆ–è¯·æ±‚é‡æ–°ç”Ÿæˆ |
| æˆæœ¬è¿‡é«˜ | å¯ç”¨æ›´æ¿€è¿›çš„ç¼“å­˜ç­–ç•¥ |

---

## ğŸ“š è¿›é˜¶ä¸»é¢˜

### 1. NPCè®°å¿†ç³»ç»Ÿ
å®ç°é•¿æœŸè®°å¿†å’ŒçŸ­æœŸè®°å¿†åˆ†ç¦»ï¼Œä½¿ç”¨å‘é‡æ•°æ®åº“ï¼ˆå¦‚Pineconeï¼‰å­˜å‚¨NPCçš„ç»å†ã€‚

### 2. æƒ…æ„Ÿæ¼”åŒ–ç³»ç»Ÿ
æ ¹æ®ç©å®¶äº’åŠ¨ï¼ŒNPCçš„æ€§æ ¼å’Œæ€åº¦ä¼šé€æ¸æ”¹å˜ã€‚

### 3. åŠ¨æ€éš¾åº¦è°ƒæ•´
AIæ ¹æ®ç©å®¶è¡¨ç°è‡ªåŠ¨è°ƒæ•´æ¸¸æˆéš¾åº¦ã€‚

### 4. å¤šNPCåä½œ
å®ç°å¤šä¸ªNPCä¹‹é—´çš„åè°ƒå’Œåˆä½œæœºåˆ¶ã€‚

---

## ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“

1. **å§‹ç»ˆéªŒè¯AIè¾“å‡º** - ä¸è¦ç›²ç›®ä¿¡ä»»AIè¿”å›çš„æ•°æ®
2. **è®¾ç½®ä¸¥æ ¼çš„è¶…æ—¶** - é¿å…å½±å“æ¸¸æˆæµç•…æ€§
3. **é€æ­¥é›†æˆAIåŠŸèƒ½** - ä»ç®€å•åœºæ™¯å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚åº¦
4. **æŒç»­ç›‘æ§æˆæœ¬** - è®¾ç½®é¢„ç®—å‘Šè­¦
5. **æ”¶é›†ç©å®¶åé¦ˆ** - AIç”Ÿæˆçš„å†…å®¹è´¨é‡éœ€è¦çœŸå®ç©å®¶éªŒè¯
6. **ä¿æŒé™çº§æ–¹æ¡ˆ** - ç¡®ä¿AIå¤±è´¥æ—¶æ¸¸æˆä»å¯ç©
7. **å®šæœŸæ›´æ–°æç¤ºè¯** - æ ¹æ®å®é™…æ•ˆæœä¸æ–­ä¼˜åŒ–
8. **A/Bæµ‹è¯•** - å¯¹æ¯”ä¸åŒæç¤ºè¯çš„æ•ˆæœ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025å¹´11æœˆ  
**ç»´æŠ¤è€…**: AI Game Dev Team

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡Issueåé¦ˆï¼
